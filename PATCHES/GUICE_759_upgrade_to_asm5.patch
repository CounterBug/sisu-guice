Description: Upgrade ASM to 5.0
Author: Stuart McCulloch <mcculls@gmail.com>
Bug-Google: http://code.google.com/p/google-guice/issues/detail?id=759
Last-Update: 2014-03-19

diff --git a/build.xml b/build.xml
index d9802ae..ac19447 100644
--- a/build.xml
+++ b/build.xml
@@ -252,7 +252,7 @@
       <arg value="-DNO_AOP" />
     </munge>
     <replace file="build/no_aop/common.xml" value="">
-      <replacetoken><![CDATA[<zipfileset src="${common.basedir}/lib/build/asm-4.2.jar"/>]]></replacetoken>
+      <replacetoken><![CDATA[<zipfileset src="${common.basedir}/lib/build/asm-5.0.jar"/>]]></replacetoken>
     </replace>
     <replace file="build/no_aop/common.xml" value="">
       <replacetoken><![CDATA[<zipfileset src="${common.basedir}/lib/build/cglib-3.1.jar"/>]]></replacetoken>
diff --git a/common.xml b/common.xml
index e54d19d..d23fbe9 100644
--- a/common.xml
+++ b/common.xml
@@ -145,7 +145,7 @@
     <jarjar jarfile="${build.dir}/${ant.project.name}-with-deps.jar">
       <fileset dir="${build.dir}/classes"/>
       <zipfileset src="${common.basedir}/lib/build/cglib-3.1.jar"/>
-      <zipfileset src="${common.basedir}/lib/build/asm-4.2.jar"/>
+      <zipfileset src="${common.basedir}/lib/build/asm-5.0.jar"/>
       <rule pattern="net.sf.cglib.*" result="com.google.inject.internal.cglib.$@1"/>
       <rule pattern="net.sf.cglib.**.*" result="com.google.inject.internal.cglib.@1.$@2"/>
       <rule pattern="org.objectweb.asm.*" result="com.google.inject.internal.asm.$@1"/>
diff --git a/core/pom.xml b/core/pom.xml
index 7606276..5346795 100644
--- a/core/pom.xml
+++ b/core/pom.xml
@@ -33,6 +33,13 @@
      | CGLIB is embedded by default by the JarJar build profile
     -->
     <dependency>
+      <groupId>org.ow2.asm</groupId>
+      <artifactId>asm</artifactId>
+      <version>5.0</version>
+      <optional>true</optional>
+      <scope>provided</scope>
+    </dependency>
+    <dependency>
       <groupId>cglib</groupId>
       <artifactId>cglib</artifactId>
       <version>3.1</version>
diff --git a/lib/build/asm-4.2.jar b/lib/build/asm-4.2.jar
deleted file mode 100644
index 693913d..0000000
Binary files a/lib/build/asm-4.2.jar and /dev/null differ
diff --git a/lib/build/asm-5.0.jar b/lib/build/asm-5.0.jar
new file mode 100644
index 0000000..2e26615
Binary files /dev/null and b/lib/build/asm-5.0.jar differ
